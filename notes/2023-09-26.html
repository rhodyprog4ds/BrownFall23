

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>6. Tidy Data and Structural Repairs &#8212; Programming for Data Science at URI Fall 2023</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/course-admonitions.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notes/2023-09-26';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7. Reparing values" href="2023-09-28.html" />
    <link rel="prev" title="5. Visualization" href="2023-09-21.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/310_2021.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/310_2021.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    About this Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Syllabus</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../syllabus/about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../syllabus/tools.html">Tools and Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../syllabus/achievements.html">Data Science Achievements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../syllabus/grading.html">Grading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../syllabus/policies.html">Grading Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../syllabus/style.html">Course  Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../syllabus/uri_resources.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../syllabus/uri_statements.html">General URI Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../syllabus/communication.html">Communications &amp; Office Hours</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="2023-09-07.html">1. Welcome &amp; What is Data Science</a></li>
<li class="toctree-l1"><a class="reference internal" href="2023-09-12.html">2. Iterables and Pandas Data Frames</a></li>
<li class="toctree-l1"><a class="reference internal" href="2023-09-14.html">3. DataFrames from other sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="2023-09-19.html">4. Exploratory Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="2023-09-21.html">5. Visualization</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">6. Tidy Data and Structural Repairs</a></li>
<li class="toctree-l1"><a class="reference internal" href="2023-09-28.html">7. Reparing values</a></li>
<li class="toctree-l1"><a class="reference internal" href="2023-10-03.html">8. Merging Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="2023-10-05.html">9. Web Scraping</a></li>
<li class="toctree-l1"><a class="reference internal" href="2023-10-12.html">10. Evaluating ML Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="2023-10-17.html">11. Intro to ML &amp; Naive Bayes</a></li>
<li class="toctree-l1"><a class="reference internal" href="2023-10-19.html">12. Understanding Classification</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Assignments</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../assignments/01-syllabus-install.html">1. Assignment 1: Setup, Syllabus, and Review</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/02-python-access.html">2. Assignment 2: Practicing Python and Accessing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/03-eda.html">3. Assignment 3: Exploratory Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/04-prepare.html">4. Assignment 4: Cleaning Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/05-construct.html">5. Assignment 5: Constructing Datasets and Using Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/06-evaluate.html">6. Assignment 6: Auditing Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/07-classification.html">7. Assignment 7</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Portfolio</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../portfolio/index.html">Portfolio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../portfolio/formatting.html">Formatting Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../portfolio/check1ideas.html">Portfolio Check 1 Ideas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../portfolio/check2ideas.html">Check 2 Ideas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../portfolio/check3ideas.html">Check 3 Ideas</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">FAQ</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/syllabus.html">Syllabus and Grading FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/github.html">Git and GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/debugging.html">Code Errors</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../resources/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/python.html">References on Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/cheatsheet.html">Cheatsheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/datasets.html">Data Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/tips.html">General Tips and Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/learning.html">How to Study in this class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/gettinghelp.html">Getting Help with Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/terminal.html">Terminals and Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/organization.html">Getting Organized for class</a></li>
<li class="toctree-l1"><a class="reference external" href="https://rhodyprog4ds.github.io/BrownFall20/letters/">Advice from FA2020 Students</a></li>
<li class="toctree-l1"><a class="reference external" href="https://rhodyprog4ds.github.io/BrownFall21/letters/">Advice from FA2021 Students</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/rhodyprog4ds/BrownFall23" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/rhodyprog4ds/BrownFall23/edit/main/notes/2023-09-26.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/rhodyprog4ds/BrownFall23/issues/new?title=Issue%20on%20page%20%2Fnotes/2023-09-26.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notes/2023-09-26.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tidy Data and Structural Repairs</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intro">6.1. Intro</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-tidy-data">6.2. What is Tidy Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tidying-data">6.3. Tidying Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transforming-the-coffee-data">6.4. Transforming the Coffee Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-data">6.5. Filtering Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-manipulations">6.6. More manipulations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#questions-after-class">6.7. Questions after Class</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-the-data-we-had-about-treatment-a-and-treatment-b-say-there-was-another-column-that-provided-information-about-the-age-of-the-people-could-we-create-another-value-variable-to-or-would-we-put-it-in-the-value-vars-list-along-with-treatment-a-and-treatmentb">6.7.1. In the data we had about treatment a and treatment b.  Say there was another column that provided information about the age of the people.  Could we create another value variable to or would we put it in the value_vars list along with treatment a and treatmentb?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#are-there-any-prebuilt-methods-to-identify-and-remove-extreme-outliers">6.7.2. Are there any prebuilt methods to identify and remove extreme outliers?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#is-there-a-specific-metric-to-which-a-dataset-must-meet-to-consider-it-cleaned">6.7.3. Is there a specific metric to which a dataset must meet to consider it ‘cleaned’?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-melt-work-underneath-the-hood">6.7.4. how does melt work underneath the hood?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#do-people-ever-write-their-melted-datasets-to-new-files-for-redistribution-maybe-to-make-things-easier-for-future-researchers">6.7.5. Do people ever write their melted datasets to new files for redistribution, maybe to make things easier for future researchers?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-ending-graphs-are-hard-to-read-is-there-a-way-to-label-specific-countries-kde-lines">6.7.6. the ending graphs are hard to read. Is there a way to label specific countries kde lines?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-do-you-get-the-index-of-something-in-a-row">6.7.7. how do you get the index of something in a row</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#i-was-trying-to-do-somthing-earlier-where-i-got-the-max-of-a-column-but-wanted-to-know-somthing-else-associated-with-that-row">6.7.8. i was trying to do somthing earlier where I got the max of a column but wanted to know somthing else associated with that row</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cleaning-out-different-data-types">6.7.9. cleaning out different data types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#is-there-a-scenario-where-a-dataset-cannot-be-cleaned-using-pandas-methods">6.7.10. Is there a scenario where a dataset cannot be cleaned using pandas methods?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#is-there-another-standard-format-for-sharing-cleaned-datasets">6.7.11. Is there another standard format for sharing cleaned datasets?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#with-extremely-large-datasets-is-there-a-way-to-find-what-pieces-of-the-dataset-are-missing-values-other-than-manually-checking">6.7.12. With extremely large datasets, is there a way to find what pieces of the dataset are missing values other than manually checking</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tidy-data-and-structural-repairs">
<h1><span class="section-number">6. </span>Tidy Data and Structural Repairs<a class="headerlink" href="#tidy-data-and-structural-repairs" title="Permalink to this headline">#</a></h1>
<section id="intro">
<h2><span class="section-number">6.1. </span>Intro<a class="headerlink" href="#intro" title="Permalink to this headline">#</a></h2>
<p>This week, we’ll be cleaning data.</p>
<p>Cleaning data is <strong>labor intensive</strong> and requires making <em>subjective</em> choices.<br />
We’ll focus on, and assess you on, manipulating data correctly, making reasonable
choices, and documenting the choices you make carefully.</p>
<p>We’ll focus on the programming tools that get used in cleaning data in class
this week:</p>
<ul class="simple">
<li><p>reshaping data</p></li>
<li><p>handling missing or incorrect values</p></li>
<li><p>renaming columns</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>this is incomplete, but will get filled in this week.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1"># make plots look nicer and increase font size</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;colorblind&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="what-is-tidy-data">
<h2><span class="section-number">6.2. </span>What is Tidy Data<a class="headerlink" href="#what-is-tidy-data" title="Permalink to this headline">#</a></h2>
<p>Read in the three csv files described below and store them in a list of dataFrames</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url_base</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/rhodyprog4ds/rhodyds/main/data/&#39;</span>

<span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;study_a.csv&#39;</span><span class="p">,</span><span class="s1">&#39;study_b.csv&#39;</span><span class="p">,</span><span class="s1">&#39;study_c.csv&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">study_df_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url_base</span> <span class="o">+</span><span class="n">cur_study</span><span class="p">,</span><span class="n">na_values</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> 
                 <span class="k">for</span> <span class="n">cur_study</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">study_df_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>treatmenta</th>
      <th>treatmentb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John Smith</td>
      <td>NaN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jane Doe</td>
      <td>16.0</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mary Johnson</td>
      <td>3.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">study_df_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>intervention</th>
      <th>John Smith</th>
      <th>Jane Doe</th>
      <th>Mary Johnson</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>treatmenta</td>
      <td>NaN</td>
      <td>16</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>treatmentb</td>
      <td>2.0</td>
      <td>11</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">study_df_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>person</th>
      <th>treatment</th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John Smith</td>
      <td>a</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jane Doe</td>
      <td>a</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mary Johnson</td>
      <td>a</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>John Smith</td>
      <td>b</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Jane Doe</td>
      <td>b</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Mary Johnson</td>
      <td>b</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>These three all show the same data, but let’s say we have two goals:</p>
<ul class="simple">
<li><p>find the average  effect per person across treatments</p></li>
<li><p>find the average effect per treatment across people</p></li>
</ul>
<p>This works differently for these three versions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_a</span> <span class="o">=</span> <span class="n">study_df_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">df_a</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>treatmenta    9.500000
treatmentb    4.666667
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>we get the average per treatment, but to get the average per person, we have to go across rows, which we can do here, but doesn’t work as well with plotting</p>
<p>we can work across rows with the <code class="docutils literal notranslate"><span class="pre">axis</span></code> parameter if needed</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_a</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     2.0
1    13.5
2     2.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_b</span> <span class="o">=</span> <span class="n">study_df_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">df_b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>intervention</th>
      <th>John Smith</th>
      <th>Jane Doe</th>
      <th>Mary Johnson</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>treatmenta</td>
      <td>NaN</td>
      <td>16</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>treatmentb</td>
      <td>2.0</td>
      <td>11</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now we get the average per person, but what about per treatment? again we have to go across rows instead.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">study_df_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>person</th>
      <th>treatment</th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John Smith</td>
      <td>a</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jane Doe</td>
      <td>a</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mary Johnson</td>
      <td>a</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>John Smith</td>
      <td>b</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Jane Doe</td>
      <td>b</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Mary Johnson</td>
      <td>b</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>For the third one, however, we can use groupby, because this one is tidy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">study_df_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;treatment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
    <tr>
      <th>treatment</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>9.500000</td>
    </tr>
    <tr>
      <th>b</th>
      <td>4.666667</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">study_df_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;person&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
    <tr>
      <th>person</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jane Doe</th>
      <td>13.5</td>
    </tr>
    <tr>
      <th>John Smith</th>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Mary Johnson</th>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The original <a class="reference external" href="https://www.jstatsoft.org/article/view/v059i10">Tidy Data</a> paper is worth reading to build a deeper understanding of these ideas.</p>
</section>
<section id="tidying-data">
<h2><span class="section-number">6.3. </span>Tidying Data<a class="headerlink" href="#tidying-data" title="Permalink to this headline">#</a></h2>
<p>Let’s reshape the first one to match the tidy one. First, we
will save it to a DataFrame, this makes things easier to read
and enables us to use the built in help in jupyter, because it can’t check types too many levels into a data structure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_a</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;treatmenta&#39;</span><span class="p">,</span><span class="s1">&#39;treatmentb&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John Smith</td>
      <td>treatmenta</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jane Doe</td>
      <td>treatmenta</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mary Johnson</td>
      <td>treatmenta</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>John Smith</td>
      <td>treatmentb</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Jane Doe</td>
      <td>treatmentb</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Mary Johnson</td>
      <td>treatmentb</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>When we melt a dataset:</p>
<ul class="simple">
<li><p>the <code class="docutils literal notranslate"><span class="pre">id_vars</span></code> stay as columns</p></li>
<li><p>the data from the <code class="docutils literal notranslate"><span class="pre">value_vars</span></code> columns become the values in the <code class="docutils literal notranslate"><span class="pre">value</span></code> column</p></li>
<li><p>the column names from the <code class="docutils literal notranslate"><span class="pre">value_vars</span></code> become the values in the <code class="docutils literal notranslate"><span class="pre">variable</span></code> column</p></li>
<li><p>we can rename the value and the variable columns.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_a</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;treatmenta&#39;</span><span class="p">,</span><span class="s1">&#39;treatmentb&#39;</span><span class="p">],</span>
          <span class="n">var_name</span><span class="o">=</span> <span class="s1">&#39;treatment_type&#39;</span><span class="p">,</span>
          <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;result&#39;</span><span class="p">,)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>treatment_type</th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John Smith</td>
      <td>treatmenta</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jane Doe</td>
      <td>treatmenta</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mary Johnson</td>
      <td>treatmenta</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>John Smith</td>
      <td>treatmentb</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Jane Doe</td>
      <td>treatmentb</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Mary Johnson</td>
      <td>treatmentb</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="transforming-the-coffee-data">
<h2><span class="section-number">6.4. </span>Transforming the Coffee Data<a class="headerlink" href="#transforming-the-coffee-data" title="Permalink to this headline">#</a></h2>
<p>Let’s do it for our coffee data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arabica_data_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/jldbc/coffee-quality-database/master/data/arabica_data_cleaned.csv&#39;</span>
<span class="c1"># load the data</span>
<span class="n">coffee_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">arabica_data_url</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>Owner</th>
      <th>Country.of.Origin</th>
      <th>Farm.Name</th>
      <th>Lot.Number</th>
      <th>Mill</th>
      <th>ICO.Number</th>
      <th>Company</th>
      <th>Altitude</th>
      <th>Region</th>
      <th>...</th>
      <th>Color</th>
      <th>Category.Two.Defects</th>
      <th>Expiration</th>
      <th>Certification.Body</th>
      <th>Certification.Address</th>
      <th>Certification.Contact</th>
      <th>unit_of_measurement</th>
      <th>altitude_low_meters</th>
      <th>altitude_high_meters</th>
      <th>altitude_mean_meters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Arabica</td>
      <td>metad plc</td>
      <td>Ethiopia</td>
      <td>metad plc</td>
      <td>NaN</td>
      <td>metad plc</td>
      <td>2014/2015</td>
      <td>metad agricultural developmet plc</td>
      <td>1950-2200</td>
      <td>guji-hambela</td>
      <td>...</td>
      <td>Green</td>
      <td>0</td>
      <td>April 3rd, 2016</td>
      <td>METAD Agricultural Development plc</td>
      <td>309fcf77415a3661ae83e027f7e5f05dad786e44</td>
      <td>19fef5a731de2db57d16da10287413f5f99bc2dd</td>
      <td>m</td>
      <td>1950.0</td>
      <td>2200.0</td>
      <td>2075.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Arabica</td>
      <td>metad plc</td>
      <td>Ethiopia</td>
      <td>metad plc</td>
      <td>NaN</td>
      <td>metad plc</td>
      <td>2014/2015</td>
      <td>metad agricultural developmet plc</td>
      <td>1950-2200</td>
      <td>guji-hambela</td>
      <td>...</td>
      <td>Green</td>
      <td>1</td>
      <td>April 3rd, 2016</td>
      <td>METAD Agricultural Development plc</td>
      <td>309fcf77415a3661ae83e027f7e5f05dad786e44</td>
      <td>19fef5a731de2db57d16da10287413f5f99bc2dd</td>
      <td>m</td>
      <td>1950.0</td>
      <td>2200.0</td>
      <td>2075.0</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 43 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Species&#39;, &#39;Owner&#39;, &#39;Country.of.Origin&#39;, &#39;Farm.Name&#39;, &#39;Lot.Number&#39;,
       &#39;Mill&#39;, &#39;ICO.Number&#39;, &#39;Company&#39;, &#39;Altitude&#39;, &#39;Region&#39;, &#39;Producer&#39;,
       &#39;Number.of.Bags&#39;, &#39;Bag.Weight&#39;, &#39;In.Country.Partner&#39;, &#39;Harvest.Year&#39;,
       &#39;Grading.Date&#39;, &#39;Owner.1&#39;, &#39;Variety&#39;, &#39;Processing.Method&#39;, &#39;Aroma&#39;,
       &#39;Flavor&#39;, &#39;Aftertaste&#39;, &#39;Acidity&#39;, &#39;Body&#39;, &#39;Balance&#39;, &#39;Uniformity&#39;,
       &#39;Clean.Cup&#39;, &#39;Sweetness&#39;, &#39;Cupper.Points&#39;, &#39;Total.Cup.Points&#39;,
       &#39;Moisture&#39;, &#39;Category.One.Defects&#39;, &#39;Quakers&#39;, &#39;Color&#39;,
       &#39;Category.Two.Defects&#39;, &#39;Expiration&#39;, &#39;Certification.Body&#39;,
       &#39;Certification.Address&#39;, &#39;Certification.Contact&#39;, &#39;unit_of_measurement&#39;,
       &#39;altitude_low_meters&#39;, &#39;altitude_high_meters&#39;, &#39;altitude_mean_meters&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scores_of_interest</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Aroma&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Flavor&#39;</span><span class="p">,</span> <span class="s1">&#39;Aftertaste&#39;</span><span class="p">,</span> <span class="s1">&#39;Acidity&#39;</span><span class="p">,</span> <span class="s1">&#39;Body&#39;</span><span class="p">,</span> <span class="s1">&#39;Balance&#39;</span><span class="p">,</span> <span class="s1">&#39;Uniformity&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Clean.Cup&#39;</span><span class="p">,</span> <span class="s1">&#39;Sweetness&#39;</span><span class="p">,]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df</span><span class="p">[</span><span class="n">scores_of_interest</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Aroma</th>
      <th>Flavor</th>
      <th>Aftertaste</th>
      <th>Acidity</th>
      <th>Body</th>
      <th>Balance</th>
      <th>Uniformity</th>
      <th>Clean.Cup</th>
      <th>Sweetness</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>8.67</td>
      <td>8.83</td>
      <td>8.67</td>
      <td>8.75</td>
      <td>8.50</td>
      <td>8.42</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8.75</td>
      <td>8.67</td>
      <td>8.50</td>
      <td>8.58</td>
      <td>8.42</td>
      <td>8.42</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can make this tall using melt to transform with that set of questions and then rename the <code class="docutils literal notranslate"><span class="pre">value</span></code> and <code class="docutils literal notranslate"><span class="pre">variable</span></code> columns to be descriptive.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df_tall</span> <span class="o">=</span> <span class="n">coffee_df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;Country.of.Origin&#39;</span><span class="p">,</span><span class="n">value_vars</span><span class="o">=</span><span class="n">scores_of_interest</span><span class="p">,</span>
               <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;rating_type&#39;</span><span class="p">,</span>
               <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;score&#39;</span><span class="p">)</span>
<span class="n">coffee_df_tall</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country.of.Origin</th>
      <th>rating_type</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ethiopia</td>
      <td>Aroma</td>
      <td>8.67</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Notice that the actual column names inside the <code class="docutils literal notranslate"><span class="pre">scores_of_interest</span></code> variable become the values in the variable column.</p>
<p>This one we can plot in more ways:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">displot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">coffee_df_tall</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;kde&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;score&#39;</span><span class="p">,</span>
            <span class="n">col</span><span class="o">=</span><span class="s1">&#39;rating_type&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Country.of.Origin&#39;</span><span class="p">,</span><span class="n">col_wrap</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2215/2608901824.py:1: UserWarning: Dataset has 0 variance; skipping density estimate. Pass `warn_singular=False` to disable this warning.
  sns.displot(data = coffee_df_tall, kind = &#39;kde&#39;, x=&#39;score&#39;,
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x7f031be1ca90&gt;
</pre></div>
</div>
<img alt="../_images/01966c2964b5299869c4504f3b25be9af6ea3bf5090c738127c5c89b25cecb50.png" src="../_images/01966c2964b5299869c4504f3b25be9af6ea3bf5090c738127c5c89b25cecb50.png" />
</div>
</div>
<p>find why warning</p>
</section>
<section id="filtering-data">
<h2><span class="section-number">6.5. </span>Filtering Data<a class="headerlink" href="#filtering-data" title="Permalink to this headline">#</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>this was not in class this week, but is added here for completeness</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">high_prod</span> <span class="o">=</span> <span class="n">coffee_df</span><span class="p">[</span><span class="n">coffee_df</span><span class="p">[</span><span class="s1">&#39;Number.of.Bags&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">250</span><span class="p">]</span>
<span class="n">high_prod</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(368, 43)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1311, 43)
</pre></div>
</div>
</div>
</div>
<p>We see that filters and reduces.  We can use any boolean expression in the square brackets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">top_balance</span> <span class="o">=</span> <span class="n">coffee_df</span><span class="p">[</span><span class="n">coffee_df</span><span class="p">[</span><span class="s1">&#39;Balance&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">coffee_df</span><span class="p">[</span><span class="s1">&#39;Balance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">.75</span><span class="p">)]</span>
<span class="n">top_balance</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(252, 43)
</pre></div>
</div>
</div>
</div>
<p>We can confirm that we got only the top 25% of balance scores:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">top_balance</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Number.of.Bags</th>
      <th>Aroma</th>
      <th>Flavor</th>
      <th>Aftertaste</th>
      <th>Acidity</th>
      <th>Body</th>
      <th>Balance</th>
      <th>Uniformity</th>
      <th>Clean.Cup</th>
      <th>Sweetness</th>
      <th>Cupper.Points</th>
      <th>Total.Cup.Points</th>
      <th>Moisture</th>
      <th>Category.One.Defects</th>
      <th>Quakers</th>
      <th>Category.Two.Defects</th>
      <th>altitude_low_meters</th>
      <th>altitude_high_meters</th>
      <th>altitude_mean_meters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>252.000000</td>
      <td>252.000000</td>
      <td>252.000000</td>
      <td>252.000000</td>
      <td>252.000000</td>
      <td>252.000000</td>
      <td>252.000000</td>
      <td>252.000000</td>
      <td>252.000000</td>
      <td>252.000000</td>
      <td>252.000000</td>
      <td>252.00000</td>
      <td>252.000000</td>
      <td>252.000000</td>
      <td>252.000000</td>
      <td>252.000000</td>
      <td>190.000000</td>
      <td>190.000000</td>
      <td>190.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>153.337302</td>
      <td>7.808889</td>
      <td>7.837659</td>
      <td>7.734167</td>
      <td>7.824881</td>
      <td>7.780159</td>
      <td>8.003095</td>
      <td>9.885278</td>
      <td>9.896667</td>
      <td>9.885952</td>
      <td>7.865714</td>
      <td>84.52504</td>
      <td>0.072579</td>
      <td>0.361111</td>
      <td>0.150794</td>
      <td>2.801587</td>
      <td>1343.138168</td>
      <td>1424.547053</td>
      <td>1383.842611</td>
    </tr>
    <tr>
      <th>std</th>
      <td>126.498576</td>
      <td>0.355319</td>
      <td>0.318172</td>
      <td>0.302481</td>
      <td>0.320253</td>
      <td>0.317712</td>
      <td>0.213056</td>
      <td>0.363303</td>
      <td>0.470514</td>
      <td>0.380433</td>
      <td>0.383738</td>
      <td>1.91563</td>
      <td>0.051682</td>
      <td>1.249923</td>
      <td>0.692216</td>
      <td>4.659771</td>
      <td>480.927004</td>
      <td>503.063351</td>
      <td>484.286247</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>5.080000</td>
      <td>7.170000</td>
      <td>6.920000</td>
      <td>7.080000</td>
      <td>5.250000</td>
      <td>7.830000</td>
      <td>6.670000</td>
      <td>5.330000</td>
      <td>6.670000</td>
      <td>5.170000</td>
      <td>77.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>12.750000</td>
      <td>7.647500</td>
      <td>7.670000</td>
      <td>7.500000</td>
      <td>7.670000</td>
      <td>7.670000</td>
      <td>7.830000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>7.670000</td>
      <td>83.42000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1162.500000</td>
      <td>1200.000000</td>
      <td>1200.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>165.500000</td>
      <td>7.780000</td>
      <td>7.830000</td>
      <td>7.750000</td>
      <td>7.830000</td>
      <td>7.750000</td>
      <td>7.920000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>7.830000</td>
      <td>84.46000</td>
      <td>0.100000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1400.000000</td>
      <td>1500.000000</td>
      <td>1450.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>275.000000</td>
      <td>8.000000</td>
      <td>8.000000</td>
      <td>7.920000</td>
      <td>8.000000</td>
      <td>7.920000</td>
      <td>8.080000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>8.080000</td>
      <td>85.52000</td>
      <td>0.110000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>1695.000000</td>
      <td>1800.000000</td>
      <td>1750.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>360.000000</td>
      <td>8.750000</td>
      <td>8.830000</td>
      <td>8.670000</td>
      <td>8.750000</td>
      <td>8.580000</td>
      <td>8.750000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>9.250000</td>
      <td>90.58000</td>
      <td>0.210000</td>
      <td>10.000000</td>
      <td>6.000000</td>
      <td>40.000000</td>
      <td>2560.000000</td>
      <td>2560.000000</td>
      <td>2560.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can also use the <code class="docutils literal notranslate"><span class="pre">isin</span></code> method to filter by comparing to an iterable type</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total_per_country</span> <span class="o">=</span> <span class="n">coffee_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Country.of.Origin&#39;</span><span class="p">)[</span><span class="s1">&#39;Number.of.Bags&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">top_countries</span> <span class="o">=</span> <span class="n">total_per_country</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="n">top_coffee_df</span> <span class="o">=</span> <span class="n">coffee_df</span><span class="p">[</span><span class="n">coffee_df</span><span class="p">[</span><span class="s1">&#39;Country.of.Origin&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">top_countries</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="more-manipulations">
<h2><span class="section-number">6.6. </span>More manipulations<a class="headerlink" href="#more-manipulations" title="Permalink to this headline">#</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>this was not in class this week, but is added here for completeness</p>
</div>
<p>Here, we will make a tiny <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> from scratch to illustrate a couple of points</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">large_num_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span> <span class="p">[[</span><span class="mi">730000000</span><span class="p">,</span><span class="mi">392000000</span><span class="p">,</span><span class="mi">580200000</span><span class="p">],</span>
                                   <span class="p">[</span><span class="mi">315040009</span><span class="p">,</span><span class="mi">580000000</span><span class="p">,</span><span class="mi">967290000</span><span class="p">]],</span>
                           <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">large_num_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>730000000</td>
      <td>392000000</td>
      <td>580200000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>315040009</td>
      <td>580000000</td>
      <td>967290000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This dataet is not tidy, but making it this way was faster to set it up.  We could make it tidy using melt as is.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">large_num_df</span><span class="o">.</span><span class="n">melt</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>730000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a</td>
      <td>315040009</td>
    </tr>
    <tr>
      <th>2</th>
      <td>b</td>
      <td>392000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>b</td>
      <td>580000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>c</td>
      <td>580200000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>c</td>
      <td>967290000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>However, I want an additional variable, so I wil reset the index, which adds an index column for the original index and adds a new index that is numerical. In this case they’re the same.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">large_num_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>730000000</td>
      <td>392000000</td>
      <td>580200000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>315040009</td>
      <td>580000000</td>
      <td>967290000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If I melt this one, using the index as the <code class="docutils literal notranslate"><span class="pre">id</span></code>, then I get a reasonable tidy DataFrame</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ls_tall_df</span> <span class="o">=</span> <span class="n">large_num_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="n">ls_tall_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>a</td>
      <td>730000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>a</td>
      <td>315040009</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>b</td>
      <td>392000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>b</td>
      <td>580000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>c</td>
      <td>580200000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>c</td>
      <td>967290000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now, we can plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">ls_tall_df</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;variable&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span>
            <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x7f02db03bbe0&gt;
</pre></div>
</div>
<img alt="../_images/d060f9c8a3e89818be7dbda4f280e624fe8ef6d6fb9a96e256519fd8db6e5be6.png" src="../_images/d060f9c8a3e89818be7dbda4f280e624fe8ef6d6fb9a96e256519fd8db6e5be6.png" />
</div>
</div>
<p>Since the numbers are so big, this might be hard to interpret.  Displaying it with all the 0s would not be easier to read.  The best thing to do is to add a new colum with adjusted values and a corresponding title.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ls_tall_df</span><span class="p">[</span><span class="s1">&#39;value (millions)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ls_tall_df</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000000</span>
<span class="n">ls_tall_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>variable</th>
      <th>value</th>
      <th>value (millions)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>a</td>
      <td>730000000</td>
      <td>730.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>a</td>
      <td>315040009</td>
      <td>315.040009</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>b</td>
      <td>392000000</td>
      <td>392.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>b</td>
      <td>580000000</td>
      <td>580.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>c</td>
      <td>580200000</td>
      <td>580.200000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now we can plot again, with the smaller values and an updated axis label.  Adding a column with the adjusted title is good practice because it does not lose any data and since we set the value and the title at the same time it keeps it clear what the values are.</p>
</section>
<section id="questions-after-class">
<h2><span class="section-number">6.7. </span>Questions after Class<a class="headerlink" href="#questions-after-class" title="Permalink to this headline">#</a></h2>
<section id="in-the-data-we-had-about-treatment-a-and-treatment-b-say-there-was-another-column-that-provided-information-about-the-age-of-the-people-could-we-create-another-value-variable-to-or-would-we-put-it-in-the-value-vars-list-along-with-treatment-a-and-treatmentb">
<h3><span class="section-number">6.7.1. </span>In the data we had about treatment a and treatment b.  Say there was another column that provided information about the age of the people.  Could we create another value variable to or would we put it in the value_vars list along with treatment a and treatmentb?<a class="headerlink" href="#in-the-data-we-had-about-treatment-a-and-treatment-b-say-there-was-another-column-that-provided-information-about-the-age-of-the-people-could-we-create-another-value-variable-to-or-would-we-put-it-in-the-value-vars-list-along-with-treatment-a-and-treatmentb" title="Permalink to this headline">#</a></h3>
<p>We can have multiple variables as the <code class="docutils literal notranslate"><span class="pre">id_vars</span></code> so that the dataset would have 4 columns instead of 3.</p>
</section>
<section id="are-there-any-prebuilt-methods-to-identify-and-remove-extreme-outliers">
<h3><span class="section-number">6.7.2. </span>Are there any prebuilt methods to identify and remove extreme outliers?<a class="headerlink" href="#are-there-any-prebuilt-methods-to-identify-and-remove-extreme-outliers" title="Permalink to this headline">#</a></h3>
<p>There may be, that is a good thing to look in the documentation for.  However, typically the definition of an outlier is best made within context, so the filtering strategy that we just used would be the way to remove them, after doign some EDA.</p>
</section>
<section id="is-there-a-specific-metric-to-which-a-dataset-must-meet-to-consider-it-cleaned">
<h3><span class="section-number">6.7.3. </span>Is there a specific metric to which a dataset must meet to consider it ‘cleaned’?<a class="headerlink" href="#is-there-a-specific-metric-to-which-a-dataset-must-meet-to-consider-it-cleaned" title="Permalink to this headline">#</a></h3>
<p>It’s “clean” when it will work for the analysis you want to do. This means clean enough for one analysis may not be enough for another goal.  Domain expertise is alwasy important.</p>
</section>
<section id="how-does-melt-work-underneath-the-hood">
<h3><span class="section-number">6.7.4. </span>how does melt work underneath the hood?<a class="headerlink" href="#how-does-melt-work-underneath-the-hood" title="Permalink to this headline">#</a></h3>
<p>The <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.melt.html">melt documentation</a> is the place to read about the details. It also includes alink to the <a class="reference external" href="https://github.com/pandas-dev/pandas/blob/v2.1.1/pandas/core/reshape/melt.py#L34-L151">source code</a> if reading how it is implemented in code is more helpful to you can reading English.</p>
</section>
<section id="do-people-ever-write-their-melted-datasets-to-new-files-for-redistribution-maybe-to-make-things-easier-for-future-researchers">
<h3><span class="section-number">6.7.5. </span>Do people ever write their melted datasets to new files for redistribution, maybe to make things easier for future researchers?<a class="headerlink" href="#do-people-ever-write-their-melted-datasets-to-new-files-for-redistribution-maybe-to-make-things-easier-for-future-researchers" title="Permalink to this headline">#</a></h3>
<p>Yes! If you look in the R Tidy Tuesday datsets most distribute the “raw” and cleaned data.</p>
</section>
<section id="the-ending-graphs-are-hard-to-read-is-there-a-way-to-label-specific-countries-kde-lines">
<h3><span class="section-number">6.7.6. </span>the ending graphs are hard to read. Is there a way to label specific countries kde lines?<a class="headerlink" href="#the-ending-graphs-are-hard-to-read-is-there-a-way-to-label-specific-countries-kde-lines" title="Permalink to this headline">#</a></h3>
<p>Yes</p>
</section>
<section id="how-do-you-get-the-index-of-something-in-a-row">
<h3><span class="section-number">6.7.7. </span>how do you get the index of something in a row<a class="headerlink" href="#how-do-you-get-the-index-of-something-in-a-row" title="Permalink to this headline">#</a></h3>
<p>I do not understand this question, please reach out with more info so that I can help you</p>
</section>
<section id="i-was-trying-to-do-somthing-earlier-where-i-got-the-max-of-a-column-but-wanted-to-know-somthing-else-associated-with-that-row">
<h3><span class="section-number">6.7.8. </span>i was trying to do somthing earlier where I got the max of a column but wanted to know somthing else associated with that row<a class="headerlink" href="#i-was-trying-to-do-somthing-earlier-where-i-got-the-max-of-a-column-but-wanted-to-know-somthing-else-associated-with-that-row" title="Permalink to this headline">#</a></h3>
<p>most pandas methods allow you to use <code class="docutils literal notranslate"><span class="pre">axis</span></code> to apply them across rows instead of columns</p>
</section>
<section id="cleaning-out-different-data-types">
<h3><span class="section-number">6.7.9. </span>cleaning out different data types<a class="headerlink" href="#cleaning-out-different-data-types" title="Permalink to this headline">#</a></h3>
<p>Once the data is loaded into pandas, we can use all of the same techniques</p>
</section>
<section id="is-there-a-scenario-where-a-dataset-cannot-be-cleaned-using-pandas-methods">
<h3><span class="section-number">6.7.10. </span>Is there a scenario where a dataset cannot be cleaned using pandas methods?<a class="headerlink" href="#is-there-a-scenario-where-a-dataset-cannot-be-cleaned-using-pandas-methods" title="Permalink to this headline">#</a></h3>
<p>yes, there are cases where cleaning the already loaded dataframe is not the best way to make the necessary fixes.  One tool that can help is called <a class="reference external" href="https://openrefine.org/">Openrefine</a> it is an open source program that provides a GUI based interface to clean data, but also outputs a script of what actions were taking, to make the cleaning replicable.</p>
<p>This is something you could learn about and try for the level 3 prepare achievement in your portfolio. One resource for learning it is the <a class="reference external" href="https://datacarpentry.org/OpenRefine-ecology-lesson/">Data Carpentry lesson on Data Cleaning for Ecologists</a></p>
</section>
<section id="is-there-another-standard-format-for-sharing-cleaned-datasets">
<h3><span class="section-number">6.7.11. </span>Is there another standard format for sharing cleaned datasets?<a class="headerlink" href="#is-there-another-standard-format-for-sharing-cleaned-datasets" title="Permalink to this headline">#</a></h3>
<p>.csv is the widely accepted preferred format for well strucutured tabular data that is of reasonable size.  If it is too large, a database might (next week!) can be useful.</p>
</section>
<section id="with-extremely-large-datasets-is-there-a-way-to-find-what-pieces-of-the-dataset-are-missing-values-other-than-manually-checking">
<h3><span class="section-number">6.7.12. </span>With extremely large datasets, is there a way to find what pieces of the dataset are missing values other than manually checking<a class="headerlink" href="#with-extremely-large-datasets-is-there-a-way-to-find-what-pieces-of-the-dataset-are-missing-values-other-than-manually-checking" title="Permalink to this headline">#</a></h3>
<p>Using strategies like we did to day, by testing dropping and the EDA strategies that we used last week can help.  If it is a very large dataset, you may need to use more powerful system, but the basics work out the same.</p>
<p>Also, remember in most contexts, you will have some relevant domain knowledge that can help you.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notes"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="2023-09-21.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Visualization</p>
      </div>
    </a>
    <a class="right-next"
       href="2023-09-28.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7. </span>Reparing values</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intro">6.1. Intro</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-tidy-data">6.2. What is Tidy Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tidying-data">6.3. Tidying Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transforming-the-coffee-data">6.4. Transforming the Coffee Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-data">6.5. Filtering Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-manipulations">6.6. More manipulations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#questions-after-class">6.7. Questions after Class</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-the-data-we-had-about-treatment-a-and-treatment-b-say-there-was-another-column-that-provided-information-about-the-age-of-the-people-could-we-create-another-value-variable-to-or-would-we-put-it-in-the-value-vars-list-along-with-treatment-a-and-treatmentb">6.7.1. In the data we had about treatment a and treatment b.  Say there was another column that provided information about the age of the people.  Could we create another value variable to or would we put it in the value_vars list along with treatment a and treatmentb?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#are-there-any-prebuilt-methods-to-identify-and-remove-extreme-outliers">6.7.2. Are there any prebuilt methods to identify and remove extreme outliers?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#is-there-a-specific-metric-to-which-a-dataset-must-meet-to-consider-it-cleaned">6.7.3. Is there a specific metric to which a dataset must meet to consider it ‘cleaned’?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-melt-work-underneath-the-hood">6.7.4. how does melt work underneath the hood?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#do-people-ever-write-their-melted-datasets-to-new-files-for-redistribution-maybe-to-make-things-easier-for-future-researchers">6.7.5. Do people ever write their melted datasets to new files for redistribution, maybe to make things easier for future researchers?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-ending-graphs-are-hard-to-read-is-there-a-way-to-label-specific-countries-kde-lines">6.7.6. the ending graphs are hard to read. Is there a way to label specific countries kde lines?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-do-you-get-the-index-of-something-in-a-row">6.7.7. how do you get the index of something in a row</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#i-was-trying-to-do-somthing-earlier-where-i-got-the-max-of-a-column-but-wanted-to-know-somthing-else-associated-with-that-row">6.7.8. i was trying to do somthing earlier where I got the max of a column but wanted to know somthing else associated with that row</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cleaning-out-different-data-types">6.7.9. cleaning out different data types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#is-there-a-scenario-where-a-dataset-cannot-be-cleaned-using-pandas-methods">6.7.10. Is there a scenario where a dataset cannot be cleaned using pandas methods?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#is-there-another-standard-format-for-sharing-cleaned-datasets">6.7.11. Is there another standard format for sharing cleaned datasets?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#with-extremely-large-datasets-is-there-a-way-to-find-what-pieces-of-the-dataset-are-missing-values-other-than-manually-checking">6.7.12. With extremely large datasets, is there a way to find what pieces of the dataset are missing values other than manually checking</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Professor Sarah M Brown
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>